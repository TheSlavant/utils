#!/usr/bin/env bash

# gx: Add, commit, and push in one go.

# Prerequisites:
# Add this to your .bashrc or .zshrc:
# gx() { /Users/yaroslavshipilov/Developer/utils/shell/gx "$@"; } # Forward all args to the script
# alias gx='noglob gx' # Ensure arguments to gx are not glob-expanded (so parentheses in commit message are literal)

# Usage: gx [commit message]
# If no message is supplied, defaults to "Update".

set -euo pipefail

if [[ $# -gt 0 ]]; then
  msg="$*"
else
  msg="Update"
fi

# Add all changes (tracked + untracked)
git add -A

# Commit only if there is anything staged
if git diff --cached --quiet; then
  echo "Nothing to commit. Skipping commit step."
else
  git commit -m "$msg"
fi

# Always attempt to push; if there is nothing new, git will say so
git push

